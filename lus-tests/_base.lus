global print, setmetatable, tostring

local testbase = {}

function testbase.new(id)
    local testinstance = { id = id, passed = 0, failed = 0 }
    setmetatable(testinstance, { __index = testbase })
    return testinstance
end

function testbase:try(name, fn)
    if ok, err = catch fn() then
        self.passed = self.passed + 1
        print("✓ " .. self.id .. "/" .. name)
    else
        self.failed = self.failed + 1
        print("✗ " .. self.id .. "/" .. name)
        print("  Error: " .. tostring(err))
    end
end

function testbase:status()
    return self.failed
end

return testbase